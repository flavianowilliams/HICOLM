---
title: "Report"
author: ""
date: ""
output: pdf_document
---

```{r setup, include=FALSE}
  knitr::opts_chunk$set(echo = TRUE,warning = FALSE, message = FALSE)
  rm(list = ls())
  graphics.off()
  library(tidyverse)
  setwd(getwd())
```

```{r, include=FALSE}
  source("import_and_clean_data.R",local = knitr::knit_global())
  source("model.R",local = knitr::knit_global())
```

This report represents a statistical analysis of the main thermodynamic variables. The figures below show the time evolution of volume, temperature, pressure and energy, followed by a smooth fitting function (red line).

## Parameters

```{r, echo=FALSE}
  cat("Ensemble:",head$X2,head$X3)
  cat("System:",head$X4,"atoms")
  if (head$X2=="npt") {
    cat("pressure:",head$X5,"atm")
  }
  if (head$X2=="nvt"|head$X2=="npt") {
    cat("temperature:",head$X6,"K")
  }
  cat("timestep:",head$X7,"ps")
  cat("time-scale:",head$X8,"ps")
```

## volume

```{r volume, echo=FALSE}
  thermo %>%
  filter(data=='volume') %>%
    ggplot(aes(x=time,y=Value))+
    geom_line(color="black")+
    geom_smooth(color="red",se=T)+
    labs(x="time (ps)",y=expression(paste("volume ",(ring(A)^3))))
```

## temperature

```{r temperature, echo=FALSE}
  thermo %>%
  filter(data=='temperature') %>%
    ggplot(aes(x=time,y=Value))+
    geom_line(color="black")+
    geom_smooth(color="red",se=T)+
    labs(x="time (ps)",y=expression(paste("temperature (K)")))
```

## pressure

```{r pressure, echo=FALSE}
  thermo %>%
  filter(data=='pressure') %>%
    ggplot(aes(x=time,y=Value))+
    geom_line(color="black")+
    geom_smooth(color="red",se=T)+
    labs(x="time (ps)",y=expression(paste("pressure (atm)")))
```

## energy

```{r energy, echo=FALSE}
  thermo %>%
  filter(data=='energy') %>%
  ggplot(aes(x=time,y=Value))+
  geom_line(color="black")+
  geom_smooth(color="red",se=T)+
  labs(x="time (ps)",y=expression(paste("energy (kcal/mol)")))
```

## density

```{r density, echo=FALSE}
  thermo %>%
  filter(data=='density') %>%
  ggplot(aes(x=time,y=Value))+
  geom_line(color="black")+
  geom_smooth(color="red",se=T)+
  labs(x="time (ps)",y=expression(paste("density (g/cm3)")))
```

## Maximum force

```{r force, echo=FALSE}
  value_max %>%
  ggplot(aes(x=time,y=fmax))+
  geom_line(color="black")+
  geom_smooth(color="red",se=T)+
  labs(x="time (ps)",y=expression(paste("F_max (kcal/mol.A)")))
```

# Gather of the thermodynamic values.

```{r facet, echo=FALSE}
  ggplot()+
    geom_line(data=filter(thermo,data=='volume'),mapping=aes(x=time,y=Value),color="black")+
    geom_smooth(data=filter(thermo,data=='volume'),mapping=aes(x=time,y=Value),color="red",se=T)+
    geom_line(data=filter(thermo,data=='temperature'),mapping=aes(x=time,y=Value),color="black")+
    geom_smooth(data=filter(thermo,data=='temperature'),mapping=aes(x=time,y=Value),color="red",se=T)+
    geom_line(data=filter(thermo,data=='pressure'),mapping=aes(x=time,y=Value),color="black")+
    geom_smooth(data=filter(thermo,data=='pressure'),mapping=aes(x=time,y=Value),color="red",se=T)+     geom_line(data=filter(thermo,data=='energy'),mapping=aes(x=time,y=Value),color="black")+
    geom_smooth(data=filter(thermo,data=='energy'),mapping=aes(x=time,y=Value),color="red",se=T)+
    geom_line(data=filter(thermo,data=='density'),mapping=aes(x=time,y=Value),color="black")+
    geom_smooth(data=filter(thermo,data=='density'),mapping=aes(x=time,y=Value),color="red",se=T)+
  facet_wrap(~data,nrow = 3,scales = 'free')
```

# Here is the summary of some thermodynamic variables.

```{r summary, echo=FALSE}
#  thermo %>%
#  spread(key="data",value="Value") %>%
#  select(volume:density) %>%
#  summary()
```
