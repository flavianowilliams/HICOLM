---
title: "Report"
author: ""
date: ""
output: pdf_document
---

```{r setup, include=FALSE}
  knitr::opts_chunk$set(echo = TRUE,warning = FALSE, message = FALSE)
  rm(list = ls())
  graphics.off()
  library(tidyverse)
  setwd(getwd())
```

```{r, include=FALSE}
  source("import_and_clean_data.R",local = knitr::knit_global())
  source("model.R",local = knitr::knit_global())
```

This report represents a statistical analysis of the main thermodynamic variables. The figures below show the time evolution of Volume, temperature, pressure and energy, followed by a smooth fitting function (red line).

## Parameters

```{r, echo=FALSE}
  cat("Ensemble:",head$X2,head$X3)
  cat("System:",head$X4,"atoms")
  if (head$X2=="npt") {
    cat("Pressure:",head$X5,"atm")
  }
  if (head$X2=="nvt"|head$X2=="npt") {
    cat("Temperature:",head$X6,"K")
  }
  cat("Timestep:",head$X7,"ps")
  cat("Time-scale:",head$X8,"ps")
```

## Volume

```{r volume, echo=FALSE}
  thermo %>%
  filter(data=='VOLUME') %>%
    ggplot(aes(x=TIME,y=Value))+
    geom_line(color="black")+
    geom_smooth(color="red",se=T)+
    labs(x="Time (ps)",y=expression(paste("Volume ",(ring(A)^3))))
```

## Temperature

```{r temperature, echo=FALSE}
  thermo %>%
  filter(data=='TEMPERATURE') %>%
    ggplot(aes(x=TIME,y=Value))+
    geom_line(color="black")+
    geom_smooth(color="red",se=T)+
    labs(x="Time (ps)",y=expression(paste("Temperature (K)")))
```

## Pressure

```{r pressure, echo=FALSE}
  thermo %>%
  filter(data=='PRESSURE') %>%
    ggplot(aes(x=TIME,y=Value))+
    geom_line(color="black")+
    geom_smooth(color="red",se=T)+
    labs(x="Time (ps)",y=expression(paste("Pressure (atm)")))
```

## Energy

```{r energy, echo=FALSE}
  thermo %>%
  filter(data=='ENERGY') %>%
  ggplot(aes(x=TIME,y=Value))+
  geom_line(color="black")+
  geom_smooth(color="red",se=T)+
  labs(x="Time (ps)",y=expression(paste("Energy (kcal/mol)")))
```

## Density

```{r density, echo=FALSE}
  thermo %>%
  filter(data=='DENSITY') %>%
  ggplot(aes(x=TIME,y=Value))+
  geom_line(color="black")+
  geom_smooth(color="red",se=T)+
  labs(x="Time (ps)",y=expression(paste("Density (g/cm3)")))
```

## Maximum force

```{r force, echo=FALSE}
  value_max %>%
  ggplot(aes(x=time,y=fmax))+
  geom_line(color="black")+
  labs(x="Time (ps)",y=expression(paste("F_max (kcal/mol.A)")))
```

# Gather of the thermodynamic values.

```{r facet, echo=FALSE}
  ggplot()+
    geom_line(data=filter(thermo,data=='VOLUME'),mapping=aes(x=TIME,y=Value),color="black")+
    geom_smooth(data=filter(thermo,data=='VOLUME'),mapping=aes(x=TIME,y=Value),color="red",se=T)+
    geom_line(data=filter(thermo,data=='TEMPERATURE'),mapping=aes(x=TIME,y=Value),color="black")+
    geom_smooth(data=filter(thermo,data=='TEMPERATURE'),mapping=aes(x=TIME,y=Value),color="red",se=T)+
    geom_line(data=filter(thermo,data=='PRESSURE'),mapping=aes(x=TIME,y=Value),color="black")+
    geom_smooth(data=filter(thermo,data=='PRESSURE'),mapping=aes(x=TIME,y=Value),color="red",se=T)+     geom_line(data=filter(thermo,data=='ENERGY'),mapping=aes(x=TIME,y=Value),color="black")+
    geom_smooth(data=filter(thermo,data=='ENERGY'),mapping=aes(x=TIME,y=Value),color="red",se=T)+
    geom_line(data=filter(thermo,data=='DENSITY'),mapping=aes(x=TIME,y=Value),color="black")+
    geom_smooth(data=filter(thermo,data=='DENSITY'),mapping=aes(x=TIME,y=Value),color="red",se=T)+
  facet_wrap(~data,nrow = 3,scales = 'free')
```

# Here is the summary of some thermodynamic variables.

```{r summary, echo=FALSE}
  thermo %>%
  spread(key="data",value="Value") %>%
  select(VOLUME:DENSITY) %>%
  summary()
```
